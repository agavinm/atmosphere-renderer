#ifndef _AEROSOL_BRACKGROUND
#define _AEROSOL_BRACKGROUND

#include <array>
#include <mitsuba/core/math.h>
#include <mitsuba/atmosphere/GlobalAtmosphericAerosol.h>

namespace backgroundAerosol {

	// row[0] = wavelength
	// row[1] = cross section absorption coefficient
	// row[2] = cross section scattering coefficient
	const static std::array<std::array<float, 1001>, 3> tabulatedValues =
	{ std::array<float, 1001>{ 100,100.23,100.46,100.69,100.93,101.16,101.39,101.62,101.86,102.09,102.33,102.57,102.8,103.04,103.28,103.51,103.75,103.99,104.23,104.47,104.71,104.95,105.2,105.44,105.68,105.93,106.17,106.41,106.66,106.91,107.15,107.4,107.65,107.89,108.14,108.39,108.64,108.89,109.14,109.4,109.65,109.9,110.15,110.41,110.66,110.92,111.17,111.43,111.69,111.94,112.2,112.46,112.72,112.98,113.24,113.5,113.76,114.03,114.29,114.55,114.82,115.08,115.35,115.61,115.88,116.14,116.41,116.68,116.95,117.22,117.49,117.76,118.03,118.3,118.58,118.85,119.12,119.4,119.67,119.95,120.23,120.5,120.78,121.06,121.34,121.62,121.9,122.18,122.46,122.74,123.03,123.31,123.59,123.88,124.17,124.45,124.74,125.03,125.31,125.6,125.89,126.18,126.47,126.77,127.06,127.35,127.64,127.94,128.23,128.53,128.82,129.12,129.42,129.72,130.02,130.32,130.62,130.92,131.22,131.52,131.83,132.13,132.43,132.74,133.05,133.35,133.66,133.97,134.28,134.59,134.9,135.21,135.52,135.83,136.14,136.46,136.77,137.09,137.4,137.72,138.04,138.36,138.68,139,139.32,139.64,139.96,140.28,140.6,140.93,141.25,141.58,141.91,142.23,142.56,142.89,143.22,143.55,143.88,144.21,144.54,144.88,145.21,145.55,145.88,146.22,146.55,146.89,147.23,147.57,147.91,148.25,148.59,148.94,149.28,149.62,149.97,150.31,150.66,151.01,151.36,151.71,152.05,152.41,152.76,153.11,153.46,153.82,154.17,154.53,154.88,155.24,155.6,155.96,156.31,156.68,157.04,157.4,157.76,158.12,158.49,158.85,159.22,159.59,159.96,160.32,160.69,161.06,161.44,161.81,162.18,162.55,162.93,163.31,163.68,164.06,164.44,164.82,165.2,165.58,165.96,166.34,166.72,167.11,167.49,167.88,168.27,168.66,169.04,169.43,169.82,170.22,170.61,171,171.4,171.79,172.19,172.58,172.98,173.38,173.78,174.18,174.58,174.98,175.39,175.79,176.2,176.6,177.01,177.42,177.83,178.24,178.65,179.06,179.47,179.89,180.3,180.72,181.13,181.55,181.97,182.39,182.81,183.23,183.65,184.08,184.5,184.93,185.35,185.78,186.21,186.64,187.07,187.5,187.93,188.36,188.8,189.23,189.67,190.11,190.55,190.99,191.43,191.87,192.31,192.75,193.2,193.64,194.09,194.54,194.98,195.43,195.88,196.34,196.79,197.24,197.7,198.15,198.61,199.07,199.53,199.99,200.45,200.91,201.37,201.84,202.3,202.77,203.24,203.7,204.17,204.64,205.12,205.59,206.06,206.54,207.01,207.49,207.97,208.45,208.93,209.41,209.89,210.38,210.86,211.35,211.84,212.32,212.81,213.3,213.8,214.29,214.78,215.28,215.77,216.27,216.77,217.27,217.77,218.27,218.78,219.28,219.79,220.29,220.8,221.31,221.82,222.33,222.84,223.36,223.87,224.39,224.91,225.42,225.94,226.46,226.99,227.51,228.03,228.56,229.09,229.61,230.14,230.67,231.21,231.74,232.27,232.81,233.35,233.88,234.42,234.96,235.5,236.05,236.59,237.14,237.68,238.23,238.78,239.33,239.88,240.44,240.99,241.55,242.1,242.66,243.22,243.78,244.34,244.91,245.47,246.04,246.6,247.17,247.74,248.31,248.89,249.46,250.03,250.61,251.19,251.77,252.35,252.93,253.51,254.1,254.68,255.27,255.86,256.45,257.04,257.63,258.23,258.82,259.42,260.02,260.62,261.22,261.82,262.42,263.03,263.63,264.24,264.85,265.46,266.07,266.69,267.3,267.92,268.53,269.15,269.77,270.4,271.02,271.64,272.27,272.9,273.53,274.16,274.79,275.42,276.06,276.69,277.33,277.97,278.61,279.25,279.9,280.54,281.19,281.84,282.49,283.14,283.79,284.45,285.1,285.76,286.42,287.08,287.74,288.4,289.07,289.73,290.4,291.07,291.74,292.42,293.09,293.76,294.44,295.12,295.8,296.48,297.17,297.85,298.54,299.23,299.92,300.61,301.3,302,302.69,303.39,304.09,304.79,305.49,306.2,306.9,307.61,308.32,309.03,309.74,310.46,311.17,311.89,312.61,313.33,314.05,314.77,315.5,316.23,316.96,317.69,318.42,319.15,319.89,320.63,321.37,322.11,322.85,323.59,324.34,325.09,325.84,326.59,327.34,328.1,328.85,329.61,330.37,331.13,331.89,332.66,333.43,334.19,334.97,335.74,336.51,337.29,338.06,338.84,339.63,340.41,341.19,341.98,342.77,343.56,344.35,345.14,345.94,346.74,347.54,348.34,349.14,349.95,350.75,351.56,352.37,353.18,354,354.81,355.63,356.45,357.27,358.1,358.92,359.75,360.58,361.41,362.24,363.08,363.92,364.75,365.59,366.44,367.28,368.13,368.98,369.83,370.68,371.54,372.39,373.25,374.11,374.97,375.84,376.7,377.57,378.44,379.32,380.19,381.07,381.94,382.82,383.71,384.59,385.48,386.37,387.26,388.15,389.05,389.94,390.84,391.74,392.64,393.55,394.46,395.37,396.28,397.19,398.11,399.02,399.94,400.87,401.79,402.72,403.65,404.58,405.51,406.44,407.38,408.32,409.26,410.2,411.15,412.1,413.05,414,414.95,415.91,416.87,417.83,418.79,419.76,420.73,421.7,422.67,423.64,424.62,425.6,426.58,427.56,428.55,429.54,430.53,431.52,432.51,433.51,434.51,435.51,436.52,437.52,438.53,439.54,440.55,441.57,442.59,443.61,444.63,445.66,446.68,447.71,448.75,449.78,450.82,451.86,452.9,453.94,454.99,456.04,457.09,458.14,459.2,460.26,461.32,462.38,463.45,464.52,465.59,466.66,467.74,468.81,469.89,470.98,472.06,473.15,474.24,475.34,476.43,477.53,478.63,479.73,480.84,481.95,483.06,484.17,485.29,486.41,487.53,488.65,489.78,490.91,492.04,493.17,494.31,495.45,496.59,497.74,498.88,500.03,501.19,502.34,503.5,504.66,505.82,506.99,508.16,509.33,510.51,511.68,512.86,514.04,515.23,516.42,517.61,518.8,520,521.19,522.4,523.6,524.81,526.02,527.23,528.45,529.66,530.88,532.11,533.33,534.56,535.8,537.03,538.27,539.51,540.75,542,543.25,544.5,545.76,547.02,548.28,549.54,550.81,552.08,553.35,554.63,555.9,557.19,558.47,559.76,561.05,562.34,563.64,564.94,566.24,567.54,568.85,570.16,571.48,572.8,574.12,575.44,576.77,578.1,579.43,580.76,582.1,583.45,584.79,586.14,587.49,588.84,590.2,591.56,592.93,594.29,595.66,597.04,598.41,599.79,601.17,602.56,603.95,605.34,606.74,608.13,609.54,610.94,612.35,613.76,615.18,616.6,618.02,619.44,620.87,622.3,623.73,625.17,626.61,628.06,629.51,630.96,632.41,633.87,635.33,636.8,638.26,639.73,641.21,642.69,644.17,645.65,647.14,648.63,650.13,651.63,653.13,654.64,656.15,657.66,659.17,660.69,662.22,663.74,665.27,666.81,668.34,669.88,671.43,672.98,674.53,676.08,677.64,679.2,680.77,682.34,683.91,685.49,687.07,688.65,690.24,691.83,693.43,695.02,696.63,698.23,699.84,701.46,703.07,704.69,706.32,707.95,709.58,711.21,712.85,714.5,716.14,717.79,719.45,721.11,722.77,724.44,726.11,727.78,729.46,731.14,732.82,734.51,736.21,737.9,739.61,741.31,743.02,744.73,746.45,748.17,749.89,751.62,753.36,755.09,756.83,758.58,760.33,762.08,763.84,765.6,767.36,769.13,770.9,772.68,774.46,776.25,778.04,779.83,781.63,783.43,785.24,787.05,788.86,790.68,792.5,794.33,796.16,797.99,799.83,801.68,803.53,805.38,807.24,809.1,810.96,812.83,814.7,816.58,818.46,820.35,822.24,824.14,826.04,827.94,829.85,831.76,833.68,835.6,837.53,839.46,841.4,843.33,845.28,847.23,849.18,851.14,853.1,855.07,857.04,859.01,860.99,862.98,864.97,866.96,868.96,870.96,872.97,874.98,877,879.02,881.05,883.08,885.12,887.16,889.2,891.25,893.31,895.36,897.43,899.5,901.57,903.65,905.73,907.82,909.91,912.01,914.11,916.22,918.33,920.45,922.57,924.7,926.83,928.97,931.11,933.25,935.41,937.56,939.72,941.89,944.06,946.24,948.42,950.6,952.8,954.99,957.19,959.4,961.61,963.83,966.05,968.28,970.51,972.75,974.99,977.24,979.49,981.75,984.01,986.28,988.55,990.83,993.12,995.41,997.7,1000 },
      std::array<float, 1001>{ 6.3963e-19,6.395e-19,6.414e-19,6.4376e-19,6.4511e-19,6.4404e-19,6.4053e-19,6.3564e-19,6.3071e-19,6.261e-19,6.2267e-19,6.2007e-19,6.1667e-19,6.1088e-19,6.0303e-19,5.9529e-19,5.8976e-19,5.8719e-19,5.8586e-19,5.8655e-19,5.8856e-19,5.9219e-19,5.9691e-19,6.0158e-19,6.0403e-19,6.0305e-19,5.9943e-19,5.9493e-19,5.9079e-19,5.8764e-19,5.8571e-19,5.8483e-19,5.8328e-19,5.7865e-19,5.7014e-19,5.597e-19,5.5039e-19,5.44e-19,5.3981e-19,5.3754e-19,5.3679e-19,5.3706e-19,5.394e-19,5.43e-19,5.4613e-19,5.4634e-19,5.4286e-19,5.3736e-19,5.3217e-19,5.2904e-19,5.2698e-19,5.2692e-19,5.2859e-19,5.305e-19,5.2974e-19,5.2394e-19,5.1367e-19,5.0228e-19,4.9315e-19,4.8773e-19,4.8505e-19,4.8514e-19,4.8776e-19,4.9229e-19,4.9972e-19,5.0891e-19,5.1717e-19,5.2142e-19,5.2098e-19,5.182e-19,5.1609e-19,5.1645e-19,5.1808e-19,5.2247e-19,5.2849e-19,5.359e-19,5.4246e-19,5.448e-19,5.4087e-19,5.3199e-19,5.2196e-19,5.1421e-19,5.0989e-19,5.0855e-19,5.0983e-19,5.1348e-19,5.1939e-19,5.2789e-19,5.3834e-19,5.477e-19,5.5233e-19,5.5099e-19,5.4612e-19,5.4161e-19,5.3996e-19,5.4075e-19,5.4441e-19,5.5056e-19,5.5876e-19,5.6844e-19,5.7744e-19,5.8241e-19,5.81e-19,5.7385e-19,5.6431e-19,5.5608e-19,5.5115e-19,5.4976e-19,5.5162e-19,5.564e-19,5.6445e-19,5.754e-19,5.8953e-19,6.0453e-19,6.1626e-19,6.2144e-19,6.2046e-19,6.171e-19,6.1529e-19,6.1679e-19,6.2096e-19,6.2788e-19,6.3692e-19,6.4789e-19,6.6039e-19,6.7315e-19,6.8364e-19,6.8906e-19,6.8807e-19,6.8191e-19,6.7369e-19,6.6652e-19,6.6217e-19,6.611e-19,6.6318e-19,6.6827e-19,6.7665e-19,6.8821e-19,7.0263e-19,7.1766e-19,7.2913e-19,7.3345e-19,7.3044e-19,7.2357e-19,7.172e-19,7.1386e-19,7.1365e-19,7.1635e-19,7.2124e-19,7.2794e-19,7.3633e-19,7.4606e-19,7.5616e-19,7.6486e-19,7.6998e-19,7.6995e-19,7.6475e-19,7.5609e-19,7.4655e-19,7.3837e-19,7.329e-19,7.3067e-19,7.3178e-19,7.3638e-19,7.447e-19,7.5656e-19,7.7103e-19,7.8546e-19,7.9589e-19,7.992e-19,7.9546e-19,7.8788e-19,7.8054e-19,7.7599e-19,7.7479e-19,7.7663e-19,7.8076e-19,7.8664e-19,7.9392e-19,8.0238e-19,8.116e-19,8.2082e-19,8.288e-19,8.3408e-19,8.3541e-19,8.3239e-19,8.2567e-19,8.1681e-19,8.0766e-19,7.9975e-19,7.9415e-19,7.914e-19,7.9185e-19,7.9575e-19,8.0313e-19,8.134e-19,8.249e-19,8.3471e-19,8.3945e-19,8.3715e-19,8.2859e-19,8.1683e-19,8.0532e-19,7.9625e-19,7.9031e-19,7.8727e-19,7.8648e-19,7.8735e-19,7.895e-19,7.9265e-19,7.9654e-19,8.0082e-19,8.0493e-19,8.0816e-19,8.0968e-19,8.0874e-19,8.0495e-19,7.9842e-19,7.8979e-19,7.8009e-19,7.7047e-19,7.6199e-19,7.5547e-19,7.5151e-19,7.5051e-19,7.5263e-19,7.5768e-19,7.6483e-19,7.7241e-19,7.7805e-19,7.7937e-19,7.7511e-19,7.6583e-19,7.5366e-19,7.4119e-19,7.3044e-19,7.2239e-19,7.1715e-19,7.1437e-19,7.1355e-19,7.1424e-19,7.1607e-19,7.1876e-19,7.2206e-19,7.2568e-19,7.2929e-19,7.325e-19,7.349e-19,7.3606e-19,7.3565e-19,7.335e-19,7.2968e-19,7.2446e-19,7.1837e-19,7.1202e-19,7.0608e-19,7.0119e-19,6.9785e-19,6.9644e-19,6.9714e-19,6.9982e-19,7.0396e-19,7.0855e-19,7.1212e-19,7.1308e-19,7.102e-19,7.0309e-19,6.9247e-19,6.7981e-19,6.6684e-19,6.5495e-19,6.4498e-19,6.3721e-19,6.3155e-19,6.2773e-19,6.2542e-19,6.2434e-19,6.2421e-19,6.2482e-19,6.2596e-19,6.2746e-19,6.291e-19,6.3069e-19,6.3204e-19,6.3293e-19,6.3322e-19,6.3277e-19,6.3155e-19,6.2958e-19,6.27e-19,6.2403e-19,6.2096e-19,6.1812e-19,6.1585e-19,6.1444e-19,6.1411e-19,6.1499e-19,6.17e-19,6.1986e-19,6.2303e-19,6.2575e-19,6.2714e-19,6.2632e-19,6.2276e-19,6.1643e-19,6.0782e-19,5.9783e-19,5.8749e-19,5.7774e-19,5.6925e-19,5.624e-19,5.573e-19,5.5387e-19,5.5196e-19,5.5136e-19,5.5187e-19,5.5331e-19,5.555e-19,5.5828e-19,5.6152e-19,5.6509e-19,5.6886e-19,5.7273e-19,5.7659e-19,5.8035e-19,5.8395e-19,5.8733e-19,5.9048e-19,5.9339e-19,5.9612e-19,5.9872e-19,6.013e-19,6.0395e-19,6.068e-19,6.0994e-19,6.1343e-19,6.173e-19,6.2148e-19,6.2582e-19,6.3006e-19,6.3384e-19,6.3676e-19,6.3839e-19,6.3839e-19,6.3655e-19,6.329e-19,6.2766e-19,6.2124e-19,6.1419e-19,6.0703e-19,6.0025e-19,5.9423e-19,5.8919e-19,5.8527e-19,5.8249e-19,5.8081e-19,5.8016e-19,5.8042e-19,5.815e-19,5.833e-19,5.8571e-19,5.8864e-19,5.9201e-19,5.9576e-19,5.998e-19,6.041e-19,6.0859e-19,6.1323e-19,6.1799e-19,6.2284e-19,6.2776e-19,6.3274e-19,6.3777e-19,6.4285e-19,6.4799e-19,6.5321e-19,6.5851e-19,6.639e-19,6.6938e-19,6.7493e-19,6.8051e-19,6.8607e-19,6.9151e-19,6.967e-19,7.0149e-19,7.0572e-19,7.0921e-19,7.1178e-19,7.1331e-19,7.1372e-19,7.1301e-19,7.1125e-19,7.0862e-19,7.0532e-19,7.016e-19,6.9775e-19,6.94e-19,6.9057e-19,6.8765e-19,6.8537e-19,6.838e-19,6.8297e-19,6.829e-19,6.8356e-19,6.8491e-19,6.8691e-19,6.895e-19,6.9264e-19,6.9627e-19,7.0034e-19,7.0481e-19,7.0962e-19,7.1474e-19,7.2014e-19,7.2578e-19,7.3164e-19,7.3768e-19,7.4388e-19,7.5023e-19,7.567e-19,7.6328e-19,7.6994e-19,7.7667e-19,7.8346e-19,7.9027e-19,7.971e-19,8.0391e-19,8.1066e-19,8.1733e-19,8.2387e-19,8.3022e-19,8.3633e-19,8.4213e-19,8.4754e-19,8.5249e-19,8.569e-19,8.607e-19,8.6382e-19,8.6623e-19,8.6789e-19,8.688e-19,8.6898e-19,8.685e-19,8.6742e-19,8.6584e-19,8.6388e-19,8.6166e-19,8.5931e-19,8.5694e-19,8.5466e-19,8.5256e-19,8.5073e-19,8.4922e-19,8.4808e-19,8.4733e-19,8.4699e-19,8.4706e-19,8.4754e-19,8.4841e-19,8.4966e-19,8.5127e-19,8.5322e-19,8.5548e-19,8.5803e-19,8.6084e-19,8.639e-19,8.6719e-19,8.7067e-19,8.7435e-19,8.7818e-19,8.8217e-19,8.8629e-19,8.9052e-19,8.9485e-19,8.9927e-19,9.0375e-19,9.0828e-19,9.1285e-19,9.1742e-19,9.2197e-19,9.2651e-19,9.31e-19,9.3542e-19,9.3975e-19,9.4396e-19,9.4802e-19,9.519e-19,9.5556e-19,9.5898e-19,9.6212e-19,9.6495e-19,9.6744e-19,9.6956e-19,9.7129e-19,9.7261e-19,9.735e-19,9.7397e-19,9.7401e-19,9.7363e-19,9.7287e-19,9.7173e-19,9.7026e-19,9.6851e-19,9.665e-19,9.6431e-19,9.6197e-19,9.5954e-19,9.5707e-19,9.5461e-19,9.522e-19,9.4989e-19,9.477e-19,9.4568e-19,9.4383e-19,9.4219e-19,9.4077e-19,9.3956e-19,9.3859e-19,9.3785e-19,9.3734e-19,9.3705e-19,9.3698e-19,9.3713e-19,9.3748e-19,9.3801e-19,9.3873e-19,9.3962e-19,9.4067e-19,9.4186e-19,9.4318e-19,9.4463e-19,9.4618e-19,9.4784e-19,9.4957e-19,9.5138e-19,9.5325e-19,9.5517e-19,9.5712e-19,9.591e-19,9.6108e-19,9.6307e-19,9.6504e-19,9.6699e-19,9.6889e-19,9.7074e-19,9.7252e-19,9.7423e-19,9.7585e-19,9.7736e-19,9.7875e-19,9.8001e-19,9.8113e-19,9.8208e-19,9.8287e-19,9.8346e-19,9.8387e-19,9.8406e-19,9.8405e-19,9.8381e-19,9.8334e-19,9.8264e-19,9.8171e-19,9.8054e-19,9.7915e-19,9.7752e-19,9.7568e-19,9.7364e-19,9.7139e-19,9.6896e-19,9.6636e-19,9.6361e-19,9.6073e-19,9.5773e-19,9.5464e-19,9.5147e-19,9.4825e-19,9.4499e-19,9.4171e-19,9.3843e-19,9.3518e-19,9.3195e-19,9.2877e-19,9.2566e-19,9.2261e-19,9.1965e-19,9.1677e-19,9.1399e-19,9.1131e-19,9.0874e-19,9.0627e-19,9.0391e-19,9.0166e-19,8.9952e-19,8.9749e-19,8.9556e-19,8.9373e-19,8.92e-19,8.9037e-19,8.8882e-19,8.8736e-19,8.8598e-19,8.8467e-19,8.8343e-19,8.8236e-19,8.8135e-19,8.8039e-19,8.7948e-19,8.7861e-19,8.7778e-19,8.7698e-19,8.762e-19,8.7544e-19,8.747e-19,8.7396e-19,8.7323e-19,8.7249e-19,8.7174e-19,8.7098e-19,8.7019e-19,8.6938e-19,8.6854e-19,8.6766e-19,8.6674e-19,8.6576e-19,8.6474e-19,8.6365e-19,8.625e-19,8.6128e-19,8.5999e-19,8.5862e-19,8.5717e-19,8.5563e-19,8.54e-19,8.5228e-19,8.5046e-19,8.4854e-19,8.4653e-19,8.4441e-19,8.4219e-19,8.3987e-19,8.3745e-19,8.3492e-19,8.3229e-19,8.2956e-19,8.2674e-19,8.2382e-19,8.2081e-19,8.1772e-19,8.1454e-19,8.1129e-19,8.0796e-19,8.0457e-19,8.0112e-19,7.9762e-19,7.9437e-19,7.9115e-19,7.8791e-19,7.8464e-19,7.8134e-19,7.7803e-19,7.7472e-19,7.714e-19,7.6808e-19,7.6478e-19,7.6148e-19,7.5821e-19,7.5496e-19,7.5174e-19,7.4855e-19,7.454e-19,7.4229e-19,7.3922e-19,7.362e-19,7.3323e-19,7.3031e-19,7.2745e-19,7.2464e-19,7.2189e-19,7.192e-19,7.1656e-19,7.1399e-19,7.1148e-19,7.0902e-19,7.0662e-19,7.0428e-19,7.02e-19,6.9978e-19,6.9761e-19,6.955e-19,6.9344e-19,6.9143e-19,6.8947e-19,6.8755e-19,6.8569e-19,6.8386e-19,6.8208e-19,6.8034e-19,6.7864e-19,6.7697e-19,6.7533e-19,6.7377e-19,6.7224e-19,6.7073e-19,6.6925e-19,6.6779e-19,6.6634e-19,6.6491e-19,6.635e-19,6.621e-19,6.6071e-19,6.5932e-19,6.5794e-19,6.5656e-19,6.5519e-19,6.5381e-19,6.5242e-19,6.5103e-19,6.4963e-19,6.4822e-19,6.468e-19,6.4536e-19,6.4391e-19,6.4244e-19,6.4095e-19,6.3944e-19,6.379e-19,6.3634e-19,6.3475e-19,6.3313e-19,6.3149e-19,6.2981e-19,6.281e-19,6.2636e-19,6.2458e-19,6.2277e-19,6.2092e-19,6.1903e-19,6.1711e-19,6.1515e-19,6.1315e-19,6.1111e-19,6.0897e-19,6.0677e-19,6.0452e-19,6.0223e-19,5.9991e-19,5.9754e-19,5.9514e-19,5.9269e-19,5.9021e-19,5.877e-19,5.8514e-19,5.8256e-19,5.7994e-19,5.7729e-19,5.746e-19,5.7189e-19,5.6916e-19,5.6639e-19,5.6361e-19,5.608e-19,5.5797e-19,5.5512e-19,5.5226e-19,5.4938e-19,5.4649e-19,5.436e-19,5.4069e-19,5.3778e-19,5.3486e-19,5.3194e-19,5.2903e-19,5.2611e-19,5.232e-19,5.203e-19,5.174e-19,5.1451e-19,5.1164e-19,5.0878e-19,5.0599e-19,5.0322e-19,5.0047e-19,4.9774e-19,4.9502e-19,4.9233e-19,4.8967e-19,4.8702e-19,4.844e-19,4.8181e-19,4.7924e-19,4.767e-19,4.7419e-19,4.7171e-19,4.6926e-19,4.6683e-19,4.6444e-19,4.6207e-19,4.5974e-19,4.5744e-19,4.5517e-19,4.5293e-19,4.5072e-19,4.4854e-19,4.4639e-19,4.4427e-19,4.4218e-19,4.4013e-19,4.381e-19,4.361e-19,4.3413e-19,4.3219e-19,4.3028e-19,4.284e-19,4.2654e-19,4.2468e-19,4.2285e-19,4.2104e-19,4.1926e-19,4.1751e-19,4.1578e-19,4.1407e-19,4.1238e-19,4.1072e-19,4.0907e-19,4.0745e-19,4.0584e-19,4.0425e-19,4.0269e-19,4.0113e-19,3.996e-19,3.9808e-19,3.9657e-19,3.9508e-19,3.936e-19,3.9213e-19,3.9068e-19,3.8923e-19,3.878e-19,3.8637e-19,3.8496e-19,3.8355e-19,3.8215e-19,3.8075e-19,3.7936e-19,3.7798e-19,3.766e-19,3.7522e-19,3.7385e-19,3.7247e-19,3.711e-19,3.6974e-19,3.6837e-19,3.67e-19,3.6563e-19,3.6425e-19,3.6288e-19,3.615e-19,3.6012e-19,3.5874e-19,3.5735e-19,3.5596e-19,3.5456e-19,3.5316e-19,3.5175e-19,3.5034e-19,3.4891e-19,3.4748e-19,3.4605e-19,3.446e-19,3.4315e-19,3.4169e-19,3.4022e-19,3.3874e-19,3.3725e-19,3.3576e-19,3.3425e-19,3.3276e-19,3.3126e-19,3.2975e-19,3.2823e-19,3.267e-19,3.2516e-19,3.2361e-19,3.2205e-19,3.2049e-19,3.1891e-19,3.1732e-19,3.1572e-19,3.1411e-19,3.1249e-19,3.1086e-19,3.0923e-19,3.0758e-19,3.0593e-19,3.0426e-19,3.0259e-19,3.0091e-19,2.9922e-19,2.9753e-19,2.9582e-19,2.9411e-19,2.924e-19,2.9067e-19,2.8894e-19,2.872e-19,2.8544e-19,2.8368e-19,2.8192e-19,2.8015e-19,2.7838e-19,2.7661e-19,2.7483e-19,2.7305e-19,2.7127e-19,2.6949e-19,2.6771e-19,2.6592e-19,2.6414e-19,2.6236e-19,2.6058e-19,2.5879e-19,2.5701e-19,2.5524e-19,2.5346e-19,2.5169e-19,2.4992e-19,2.4816e-19,2.464e-19,2.4464e-19,2.4289e-19,2.4115e-19,2.3941e-19,2.3767e-19,2.3595e-19,2.3423e-19,2.3252e-19,2.3081e-19,2.2912e-19,2.2743e-19,2.2575e-19,2.2408e-19,2.2241e-19,2.2076e-19,2.1912e-19,2.1749e-19,2.1586e-19,2.1425e-19,2.1265e-19,2.1106e-19,2.0948e-19,2.0791e-19,2.0635e-19,2.048e-19,2.0327e-19,2.0175e-19,2.0022e-19,1.987e-19,1.9719e-19,1.9569e-19,1.942e-19,1.9273e-19,1.9127e-19,1.8983e-19,1.8839e-19,1.8697e-19,1.8556e-19,1.8417e-19,1.8278e-19,1.8141e-19,1.8005e-19,1.7871e-19,1.7738e-19,1.7606e-19,1.7475e-19,1.7345e-19,1.7217e-19,1.709e-19,1.6964e-19,1.6839e-19,1.6716e-19,1.6594e-19,1.6473e-19,1.6353e-19,1.6234e-19,1.6116e-19,1.6e-19,1.5885e-19,1.5771e-19,1.5658e-19,1.5546e-19,1.5435e-19,1.5325e-19,1.5216e-19,1.5109e-19,1.5002e-19,1.4896e-19,1.4792e-19,1.4688e-19,1.4586e-19,1.4484e-19,1.4383e-19},
      std::array<float, 1001>{ 9.5529e-26,9.998e-26,1.1523e-25,1.3152e-25,1.4105e-25,1.376e-25,1.2406e-25,1.0955e-25,1.005e-25,1.0124e-25,1.0852e-25,1.1909e-25,1.2613e-25,1.2422e-25,1.1362e-25,1.0007e-25,8.938e-26,8.4162e-26,8.0611e-26,8.1599e-26,8.6561e-26,9.7623e-26,1.1308e-25,1.2872e-25,1.3585e-25,1.3021e-25,1.1643e-25,1.0337e-25,9.6036e-26,9.6199e-26,1.0256e-25,1.1251e-25,1.2134e-25,1.2364e-25,1.1723e-25,1.0537e-25,9.3717e-26,8.5947e-26,8.1333e-26,7.9926e-26,8.2043e-26,8.711e-26,9.8423e-26,1.1342e-25,1.2665e-25,1.304e-25,1.2241e-25,1.0829e-25,9.588e-26,9.0769e-26,8.8852e-26,9.3263e-26,1.0127e-25,1.1012e-25,1.1554e-25,1.1392e-25,1.0557e-25,9.4493e-26,8.4939e-26,7.8869e-26,7.5264e-26,7.4521e-26,7.7295e-26,8.291e-26,9.3904e-26,1.0814e-25,1.1994e-25,1.2259e-25,1.1469e-25,1.0157e-25,9.0193e-26,8.478e-26,8.2322e-26,8.5279e-26,9.0964e-26,9.8619e-26,1.059e-25,1.0945e-25,1.071e-25,9.98e-26,9.0785e-26,8.3136e-26,7.8005e-26,7.5157e-26,7.4571e-26,7.6741e-26,8.2059e-26,9.1307e-26,1.0377e-25,1.1478e-25,1.1841e-25,1.1247e-25,1.0063e-25,8.901e-26,8.1655e-26,7.7885e-26,7.7936e-26,8.0708e-26,8.5323e-26,9.1207e-26,9.6825e-26,9.988e-26,9.8702e-26,9.3537e-26,8.6396e-26,7.96e-26,7.4466e-26,7.123e-26,6.9901e-26,7.0603e-26,7.4193e-26,8.0591e-26,9.0389e-26,1.0119e-25,1.0834e-25,1.0799e-25,1.0037e-25,8.9686e-26,8.0525e-26,7.4999e-26,7.2365e-26,7.2571e-26,7.4574e-26,7.7934e-26,8.2314e-26,8.7038e-26,9.0876e-26,9.2448e-26,9.1037e-26,8.711e-26,8.2016e-26,7.7162e-26,7.3393e-26,7.1016e-26,7.0123e-26,7.0928e-26,7.3986e-26,7.9489e-26,8.7417e-26,9.6143e-26,1.0229e-25,1.0275e-25,9.7165e-26,8.8223e-26,7.9535e-26,7.3281e-26,6.9586e-26,6.8217e-26,6.8465e-26,6.982e-26,7.2058e-26,7.4965e-26,7.8157e-26,8.1001e-26,8.2724e-26,8.2739e-26,8.0975e-26,7.7933e-26,7.4423e-26,7.1195e-26,6.873e-26,6.7283e-26,6.7025e-26,6.8222e-26,7.1221e-26,7.6116e-26,8.2535e-26,8.9049e-26,9.329e-26,9.3274e-26,8.8843e-26,8.1806e-26,7.4633e-26,6.8976e-26,6.5266e-26,6.3357e-26,6.2796e-26,6.317e-26,6.4245e-26,6.5871e-26,6.7896e-26,7.0095e-26,7.2143e-26,7.3657e-26,7.4303e-26,7.3939e-26,7.2682e-26,7.0873e-26,6.894e-26,6.7268e-26,6.6149e-26,6.5795e-26,6.6401e-26,6.818e-26,7.128e-26,7.5582e-26,8.0502e-26,8.483e-26,8.706e-26,8.6202e-26,8.2444e-26,7.7035e-26,7.1502e-26,6.689e-26,6.3583e-26,6.1526e-26,6.0458e-26,6.0111e-26,6.0293e-26,6.0877e-26,6.1768e-26,6.2865e-26,6.4052e-26,6.518e-26,6.6087e-26,6.6625e-26,6.6699e-26,6.6306e-26,6.5538e-26,6.4563e-26,6.3581e-26,6.2793e-26,6.2379e-26,6.2496e-26,6.3287e-26,6.4858e-26,6.7222e-26,7.0197e-26,7.3322e-26,7.5868e-26,7.7039e-26,7.6335e-26,7.3828e-26,7.0132e-26,6.6079e-26,6.2361e-26,5.9363e-26,5.7181e-26,5.5743e-26,5.4907e-26,5.4539e-26,5.4534e-26,5.4808e-26,5.5296e-26,5.594e-26,5.6679e-26,5.7452e-26,5.8193e-26,5.8837e-26,5.933e-26,5.9641e-26,5.9764e-26,5.973e-26,5.9597e-26,5.9446e-26,5.9372e-26,5.9471e-26,5.9835e-26,6.0545e-26,6.1652e-26,6.3158e-26,6.4978e-26,6.691e-26,6.863e-26,6.9752e-26,6.9941e-26,6.9046e-26,6.7166e-26,6.4616e-26,6.1798e-26,5.9072e-26,5.6675e-26,5.4716e-26,5.3207e-26,5.2105e-26,5.1349e-26,5.0878e-26,5.064e-26,5.0589e-26,5.0687e-26,5.0903e-26,5.1204e-26,5.1565e-26,5.1956e-26,5.2353e-26,5.2734e-26,5.3081e-26,5.3385e-26,5.3642e-26,5.3863e-26,5.4066e-26,5.4279e-26,5.4536e-26,5.4874e-26,5.5332e-26,5.594e-26,5.6715e-26,5.7654e-26,5.8718e-26,5.9824e-26,6.0847e-26,6.1628e-26,6.2004e-26,6.1842e-26,6.1098e-26,5.9824e-26,5.8157e-26,5.6272e-26,5.4347e-26,5.2522e-26,5.0886e-26,4.9484e-26,4.8325e-26,4.7397e-26,4.6677e-26,4.6139e-26,4.5759e-26,4.5512e-26,4.5379e-26,4.5341e-26,4.5383e-26,4.549e-26,4.565e-26,4.5852e-26,4.6087e-26,4.6345e-26,4.6622e-26,4.6914e-26,4.7219e-26,4.7539e-26,4.7879e-26,4.8245e-26,4.8644e-26,4.9088e-26,4.9583e-26,5.0136e-26,5.0748e-26,5.1411e-26,5.2107e-26,5.2804e-26,5.3456e-26,5.4006e-26,5.4391e-26,5.4553e-26,5.4449e-26,5.406e-26,5.34e-26,5.2508e-26,5.1445e-26,5.0281e-26,4.9085e-26,4.7915e-26,4.6814e-26,4.581e-26,4.4918e-26,4.4142e-26,4.3481e-26,4.2927e-26,4.2472e-26,4.2107e-26,4.1822e-26,4.1608e-26,4.1457e-26,4.1362e-26,4.1316e-26,4.1313e-26,4.1349e-26,4.1419e-26,4.152e-26,4.1649e-26,4.1804e-26,4.1983e-26,4.2185e-26,4.241e-26,4.2657e-26,4.2928e-26,4.3222e-26,4.3539e-26,4.3879e-26,4.4239e-26,4.4617e-26,4.5005e-26,4.5396e-26,4.5776e-26,4.613e-26,4.6439e-26,4.6682e-26,4.6837e-26,4.6886e-26,4.6812e-26,4.6606e-26,4.6269e-26,4.5807e-26,4.5236e-26,4.4578e-26,4.3857e-26,4.31e-26,4.2331e-26,4.1572e-26,4.0839e-26,4.0149e-26,3.951e-26,3.8928e-26,3.8406e-26,3.7944e-26,3.7542e-26,3.7197e-26,3.6906e-26,3.6666e-26,3.6473e-26,3.6324e-26,3.6216e-26,3.6146e-26,3.6109e-26,3.6105e-26,3.6131e-26,3.6184e-26,3.6263e-26,3.6365e-26,3.649e-26,3.6636e-26,3.6801e-26,3.6984e-26,3.7184e-26,3.74e-26,3.763e-26,3.7872e-26,3.8123e-26,3.8382e-26,3.8645e-26,3.8908e-26,3.9167e-26,3.9415e-26,3.9647e-26,3.9856e-26,4.0035e-26,4.0175e-26,4.0271e-26,4.0314e-26,4.03e-26,4.0225e-26,4.0086e-26,3.9884e-26,3.9621e-26,3.9301e-26,3.8931e-26,3.852e-26,3.8075e-26,3.7606e-26,3.7122e-26,3.6632e-26,3.6144e-26,3.5665e-26,3.52e-26,3.4755e-26,3.4332e-26,3.3936e-26,3.3566e-26,3.3226e-26,3.2914e-26,3.2632e-26,3.2379e-26,3.2154e-26,3.1957e-26,3.1786e-26,3.1642e-26,3.1522e-26,3.1426e-26,3.1353e-26,3.1301e-26,3.127e-26,3.1259e-26,3.1267e-26,3.1292e-26,3.1333e-26,3.1391e-26,3.1463e-26,3.1548e-26,3.1646e-26,3.1754e-26,3.1873e-26,3.2e-26,3.2134e-26,3.2273e-26,3.2416e-26,3.256e-26,3.2704e-26,3.2844e-26,3.298e-26,3.3107e-26,3.3224e-26,3.3327e-26,3.3414e-26,3.3483e-26,3.353e-26,3.3554e-26,3.3553e-26,3.3525e-26,3.3469e-26,3.3385e-26,3.3272e-26,3.3132e-26,3.2964e-26,3.2772e-26,3.2557e-26,3.2321e-26,3.2067e-26,3.1798e-26,3.1517e-26,3.1228e-26,3.0932e-26,3.0633e-26,3.0334e-26,3.0036e-26,2.9743e-26,2.9455e-26,2.9175e-26,2.8905e-26,2.8644e-26,2.8394e-26,2.8157e-26,2.7932e-26,2.7719e-26,2.752e-26,2.7334e-26,2.7162e-26,2.7003e-26,2.6857e-26,2.6725e-26,2.6605e-26,2.6498e-26,2.6403e-26,2.6321e-26,2.625e-26,2.619e-26,2.6142e-26,2.6104e-26,2.6076e-26,2.6058e-26,2.6049e-26,2.6049e-26,2.6056e-26,2.6072e-26,2.6094e-26,2.6122e-26,2.6156e-26,2.6195e-26,2.6239e-26,2.6285e-26,2.6335e-26,2.6386e-26,2.6438e-26,2.649e-26,2.6541e-26,2.6591e-26,2.6638e-26,2.6681e-26,2.672e-26,2.6753e-26,2.678e-26,2.68e-26,2.6812e-26,2.6816e-26,2.6811e-26,2.6796e-26,2.6771e-26,2.6736e-26,2.6691e-26,2.6636e-26,2.657e-26,2.6494e-26,2.6408e-26,2.6312e-26,2.6208e-26,2.6096e-26,2.5976e-26,2.585e-26,2.5717e-26,2.5579e-26,2.5436e-26,2.5289e-26,2.514e-26,2.4989e-26,2.4836e-26,2.4682e-26,2.4529e-26,2.4376e-26,2.4224e-26,2.4074e-26,2.3926e-26,2.3781e-26,2.3639e-26,2.35e-26,2.3365e-26,2.3234e-26,2.3107e-26,2.2984e-26,2.2866e-26,2.2752e-26,2.2643e-26,2.2539e-26,2.2439e-26,2.2344e-26,2.2255e-26,2.2171e-26,2.2092e-26,2.2017e-26,2.1946e-26,2.188e-26,2.1818e-26,2.1759e-26,2.1705e-26,2.1654e-26,2.1608e-26,2.1564e-26,2.1524e-26,2.1487e-26,2.1454e-26,2.1423e-26,2.1395e-26,2.1369e-26,2.1345e-26,2.1324e-26,2.1305e-26,2.1287e-26,2.127e-26,2.1255e-26,2.124e-26,2.1226e-26,2.1213e-26,2.12e-26,2.1186e-26,2.1173e-26,2.1158e-26,2.1143e-26,2.1127e-26,2.1109e-26,2.109e-26,2.1069e-26,2.1045e-26,2.102e-26,2.0992e-26,2.0961e-26,2.0928e-26,2.0892e-26,2.0853e-26,2.0811e-26,2.0765e-26,2.0716e-26,2.0664e-26,2.0609e-26,2.0551e-26,2.0489e-26,2.0424e-26,2.036e-26,2.0294e-26,2.0226e-26,2.0155e-26,2.0081e-26,2.0005e-26,1.9927e-26,1.9847e-26,1.9766e-26,1.9682e-26,1.9598e-26,1.9512e-26,1.9424e-26,1.9336e-26,1.9248e-26,1.9159e-26,1.9069e-26,1.8979e-26,1.889e-26,1.8801e-26,1.8711e-26,1.8623e-26,1.8535e-26,1.8448e-26,1.8362e-26,1.8277e-26,1.8193e-26,1.811e-26,1.8029e-26,1.7949e-26,1.7871e-26,1.7794e-26,1.7719e-26,1.7646e-26,1.7574e-26,1.7504e-26,1.7436e-26,1.737e-26,1.7306e-26,1.7243e-26,1.7183e-26,1.7124e-26,1.7067e-26,1.7012e-26,1.6958e-26,1.6907e-26,1.6857e-26,1.6809e-26,1.6763e-26,1.6718e-26,1.6675e-26,1.6633e-26,1.6593e-26,1.6555e-26,1.6518e-26,1.6483e-26,1.6448e-26,1.6415e-26,1.6384e-26,1.6353e-26,1.6324e-26,1.6296e-26,1.6268e-26,1.6242e-26,1.6217e-26,1.6192e-26,1.6168e-26,1.6145e-26,1.6122e-26,1.61e-26,1.6078e-26,1.6057e-26,1.6036e-26,1.6016e-26,1.5995e-26,1.5975e-26,1.5955e-26,1.5934e-26,1.5914e-26,1.5894e-26,1.5873e-26,1.5852e-26,1.5831e-26,1.5809e-26,1.5787e-26,1.5764e-26,1.574e-26,1.5838e-26,1.6e-26,1.6161e-26,1.6322e-26,1.6481e-26,1.6639e-26,1.6796e-26,1.6951e-26,1.7106e-26,1.7258e-26,1.7409e-26,1.7559e-26,1.7706e-26,1.7852e-26,1.7996e-26,1.8139e-26,1.8279e-26,1.8417e-26,1.8553e-26,1.8688e-26,1.882e-26,1.895e-26,1.9078e-26,1.9204e-26,1.9328e-26,1.9449e-26,1.9568e-26,1.9686e-26,1.9801e-26,1.9913e-26,2.0024e-26,2.0133e-26,2.024e-26,2.0344e-26,2.0447e-26,2.0547e-26,2.0646e-26,2.0743e-26,2.0682e-26,2.0595e-26,2.0507e-26,2.0418e-26,2.033e-26,2.0241e-26,2.0151e-26,2.0062e-26,1.9973e-26,1.9883e-26,1.9794e-26,1.9705e-26,1.9616e-26,1.9528e-26,1.9439e-26,1.9352e-26,1.9264e-26,1.9177e-26,1.9091e-26,1.9006e-26,1.8921e-26,1.8837e-26,1.8753e-26,1.8671e-26,1.8589e-26,1.8509e-26,1.8429e-26,1.835e-26,1.8272e-26,1.8195e-26,1.812e-26,1.8045e-26,1.7972e-26,1.7899e-26,1.7854e-26,1.8047e-26,1.8241e-26,1.8434e-26,1.8626e-26,1.8819e-26,1.9012e-26,1.9205e-26,1.9397e-26,1.959e-26,1.9783e-26,1.9976e-26,2.017e-26,2.0363e-26,2.0557e-26,2.0752e-26,2.0947e-26,2.1142e-26,2.1338e-26,2.1534e-26,2.173e-26,2.1927e-26,2.2125e-26,2.2324e-26,2.2522e-26,2.2722e-26,2.2922e-26,2.3123e-26,2.3324e-26,2.3527e-26,2.3729e-26,2.3933e-26,2.4137e-26,2.6299e-26,2.8643e-26,3.0984e-26,3.3321e-26,3.5656e-26,3.7988e-26,4.0317e-26,4.2645e-26,4.497e-26,4.7293e-26,4.9615e-26,5.1935e-26,5.4253e-26,5.6571e-26,5.8886e-26,6.1201e-26,6.3514e-26,6.5826e-26,6.8137e-26,7.0447e-26,7.2756e-26,7.5063e-26,7.7369e-26,7.9673e-26,8.1977e-26,8.4278e-26,8.6578e-26,8.8876e-26,9.1172e-26,9.3466e-26,9.9113e-26,1.0493e-25,1.1074e-25,1.1654e-25,1.2234e-25,1.2813e-25,1.3392e-25,1.3969e-25,1.4546e-25,1.5122e-25,1.5696e-25,1.627e-25,1.6843e-25,1.7415e-25,1.7985e-25,1.8554e-25,1.9122e-25,1.9689e-25,2.0254e-25,2.0817e-25,2.1379e-25,2.1939e-25,2.2497e-25,2.3053e-25,2.3608e-25,2.416e-25,2.4711e-25,2.5259e-25,2.5161e-25,2.5007e-25,2.4853e-25,2.4698e-25,2.4543e-25,2.4387e-25,2.4231e-25,2.4073e-25,2.3916e-25,2.3757e-25,2.3598e-25,2.3439e-25,2.3279e-25,2.3118e-25,2.2957e-25,2.2796e-25,2.2634e-25,2.2472e-25,2.2309e-25,2.2146e-25,2.1983e-25,2.1819e-25,2.1655e-25,2.1491e-25,2.1327e-25,2.1162e-25,2.0997e-25,2.0832e-25,2.0667e-25,2.0502e-25,2.0337e-25,2.0172e-25,2.0006e-25,1.9841e-25,1.9676e-25,1.9511e-25,1.9346e-25,1.9181e-25,1.9017e-25,1.8852e-25,1.8688e-25,1.8524e-25,1.8361e-25,1.8198e-25,1.8035e-25,1.7872e-25,1.771e-25,1.7548e-25,1.7386e-25,1.7225e-25,1.7065e-25,1.8717e-25,2.0897e-25,2.3063e-25,2.5215e-25,2.7354e-25,2.9479e-25,3.159e-25,3.3687e-25,3.5771e-25,3.784e-25,3.9897e-25,4.1939e-25,4.3968e-25,4.5983e-25,4.7985e-25,4.9973e-25,5.1948e-25,5.3909e-25,5.5857e-25,5.7792e-25,5.9714e-25,6.1623e-25,6.3519e-25,6.5402e-25,6.7272e-25,6.913e-25,7.0975e-25,7.2808e-25,7.4628e-25,7.6437e-25,7.8233e-25,8.0017e-25,8.179e-25,8.355e-25,8.53e-25,8.7037e-25,8.8764e-25,9.0479e-25,9.2183e-25,9.3876e-25,9.5559e-25,9.7231e-25,9.8892e-25,1.0054e-24,1.0218e-24,1.0392e-24} };

	const static float base_density = 2.584e+17f;//km^-3

	const static float pb = 2e6f; // background value in km^-3

    template <typename Float, typename UInt32, typename Mask, typename Spectrum, typename Wavelength>
	class BackgroundAerosol : public GlobalAerosolModel<Float, UInt32, Mask, Spectrum, Wavelength> {
	    const float m_density;

	public:
        BackgroundAerosol() : GlobalAerosolModel<Float, UInt32, Mask, Spectrum, Wavelength>(tabulatedValues),
                m_density(base_density * (1.f + pb / base_density)) {}

        Float get_density(const Float &z) const override {
            return Float(m_density);
        }

        [[nodiscard]] float get_density_float(const float &z) const override {
            return m_density;
        }
	};
}
#endif //_AEROSOL_BACKGROUND